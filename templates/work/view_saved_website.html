{% extends 'work/base.html' %}

{% block content %}
<style>
    /* General styles */
    body {
        font-family: Arial, sans-serif;
        background-color: #f9f9f9;
        color: #333;
        margin: 0;
        padding: 20px;
    }

    h2 {
        text-align: center;
        color: #333;
        margin-bottom: 20px;
    }

    p {
        font-size: 1.2em;
        color: #555;
        margin-bottom: 20px;
    }

    iframe {
        border: none;
        border-radius: 8px;
        max-width: 100%;
        margin: 0 auto;
        display: block;
    }

    .view-button {
        display: inline-block;
        padding: 10px 20px;
        background-color: #4CAF50;
        color: white;
        text-decoration: none;
        border-radius: 5px;
        font-weight: bold;
        transition: background-color 0.3s;
    }

    .view-button:hover {
        background-color: #45a049;
    }
</style>

<h2 style="margin-top: 30px;">{{ website.title }}</h2>
<p><strong>Prompt:</strong> {{ website.prompt }}</p>

<h3>Generated Website:</h3>
<iframe id="preview" width="100%" height="500px"></iframe>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Access the iframe
        let iframe = document.getElementById('preview');
        let iframeDoc = iframe.contentDocument || iframe.contentWindow.document;

        iframeDoc.open();
        iframeDoc.write(`
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Preview</title>
            </head>
            <body>
                {{ website.body|escapejs }}
                <script>{{ website.script|escapejs }}<\/script>
            </body>
            </html>
        `);
        iframeDoc.close();

        // Inject CSS dynamically using JavaScript
        const styleTag = iframeDoc.createElement('style');
        styleTag.innerHTML = `{{ website.css|escapejs }}`;
        iframeDoc.head.appendChild(styleTag);
    });
</script>

{% endblock %}
